#TWIML Fest
https://twimlai.com/twimlfest/

#Show and Tell! ML/AI Project Lightning Talks
https://twimlai.com/twimlfest/sessions/show-and-tell/
# Encrypted Traffic Malware Presence Detector 

## Presenter

Nitin Bharadwaj Mutukula <br>
GitHub: https://github.com/Nitinbharadwajm <br>
LinkedIn: https://www.linkedin.com/in/nitin-bharadwajm

## Context
Detecting malware in traffic becomes eminent with the rise in network scale, security threats, number of IOT devices, BYOD devices etc.. Since most of the traffic is encrypted and malware creators are becoming smarter, feature engineering is extremely important in increasing the accuracy of Machine Learning algorithms for malware detection. Hardware limitations of network switches should also be considered while identifying the features to be used for Modeling. 

## Description
Our solution is to use features extracted out of packet lengths seen in sampled network flows. An open source tool called netmate captures few of the packet length statistics like Minimum, Maximum and Mean packet lengths per flow on live traffic or existing PCAP files. We have added eleven novel attributes to the tool which include eight sub-flow statistics to capture efficient packet-length based features for a flow window time. The features added are Maximum, Minimum, Mean and Standard Deviation of steps in forward and backward directions(8 attributes), number of toggles in forward and backward directions(2 attributes) and number of unique packet lengths(1 attribute). A step in forward direction is basically an increase in the packet length from the previous packet. (A step in backward direction can be inferred similarly). A toggle is when there is a change in direction of the steps. 

We have observed the impact of these newly added attributes on unsupervised clustering algorithms like KMeans and DBScan.

## Code


## Results, Outcomes, Conclusions

1. K-Means:
    When a comparison is drawn between modelling with existing flow attributes and with newly added attributes, it was observed that the average distance from the centroid within a cluster is reduced. It is a positive sign because we are able to better the similarity of flows within a cluster. The Davies Bouldin Index is also marginally improved (the lower, the better), which indicates that the clusters are formed with lower intra-cluster distances and higher inter-cluster distances. Finer patterns were also extracted from the data.
2. DBScan ran on benign and malware datasets:
    The newly added attributes are able to identify new patterns in the malware dataset. Whereas, in the case of benign dataset, the clustering doesn’t deviate much from the existing patterns. There is a significant increase in the noise points when DBSCAN is applied on a malware dataset, which may directly correlate to the malicious flows. The noise points however are fairly low in a benign dataset. 

- The increase in the noise points could be a differentiating factor for the network admin to decide if any further inspection of the flows is needed.
- DBSCAN is more hepful than K-Means because, Density clustering algorithms use the concept of reachability i.e. how many neighbors has a point within a radius. Also, DBSCAN doesn’t need the parameter ‘k’, which is the number of clusters we are trying to find, unlike KMEANS.


## Python libraries used

NumPy, Pandas, matplotlib, sklearn

## Open questions/issues
- Any better techniques to identify the optimal number of clusters for KMEANS and the optimal epsilon value for DBScan?
- How to identify the best standardization technique for our dataset. The scale of the attributes is different. (Few of them are lengths and few of them are number of packet lengths, number of steps, toggles etc.)
